\subsection{Model- og controllerkomponent}
\label{sec:modelfunktion}

Model- og controllerkomponenterne repræsenterer objekterne og deres funktionalitet i problem- og anvendelsesområderne. Vi har opdateret klassediagrammet fra problemområdet i \chapref{chap:analyseafpo} ved at benytte klassernes adfærd, der er beskrevet i \secref{sec:adfaerd}, til at danne attributter og nye klasser. Operationerne på klasserne er blevet dannet ud fra funktionerne, som er beskrevet i anvendelsesområdet i \chapref{chap:analyseafao}. Klasserne er opdateret eller ændret på anden vis ud fra analysen af problemområdet i \chapref{chap:analyseafpo}. Disse opdateringer bliver præsenteret i \figref{fig:klasseDes}.


\pdffig{klassediagramDes}
	{Det endelige klassediagram.}
	{fig:klasseDes}

Klassen \classref{Bruger} afspejler de personer, der kan bruge systemet. Der findes to slags brugere af systemet. En bruger, der har et adgangsniveau som administrator, og en bruger, der ikke har adgangsniveau som administrator. Dette håndteres af værditype-attributten \textit{adgangsniveau}, som ses i \figref{fig:klasseDes}. En bruger, der er administrator kan læse og rette fejl, der er indberettet af en almindelig bruger. Derudover kan en administrator slette andre brugere af systemet. Vi kunne godt have brugt rollemønsteret, hvor klassen \classref{Bruger} kunne have en rolle som administrator eller en rolle som almindelig bruger. Vi mente dog at forskellen på de to roller (administrator og bruger) var for lille til, at vi ville benytte rollemønsteret, og benyttede i stedet en attribut til at beskrive deres rolle. Alle brugere har adgang til funktionerne \methodref{ret stamdata()}, \methodref{håndter indkøbsliste()}, \methodref{håndter favoritter()} og \methodref{fejlrapport()}, som går ud på at indberette en fejl vedr. siden eller en opskrift.
For at en bruger, der har benyttet systemet tidligere, kan få adgang til sin indkøbsliste og favoritter, tilføjes attributterne \textit{email} og \textit{adgangskode} til \classref{Bruger}-klassen. På den måde kan systemet hurtigt finde den rigtige \classref{Bruger}-klasse og forhindrer samtidig andre at få adgang til det samme \classref{Bruger}-objekt, medmindre de selvfølgelig kender den pågældende email og adgangskode.

Det er ikke obligatorisk at være logget ind på systemet for at bruge det. Klassen \classref{Bruger} har fortsat de samme associationer til \classref{Fejlrapport}, \classref{Opskrift} og \classref{Vare}, som klassen havde i problemområdet. Klassen \classref{Fejlrapport} er dog blevet delt op i to klasser; \classref{Fejl} og \classref{Fejlkategori}.

I problemområdet er hændelsen ``fejl rapporteret'' en iteration, hvilket er grundlag for at klassen \classref{Fejl} oprettes. Man kan forestille sig, at der kan forekomme mange forskellige typer fejl. Det kan være fejl i en opskrift, på indkøbslisten eller på søgesiden. For at lette overblikket over håndteringen af disse fejl for en administrator, tilføjer vi klassen \classref{Fejlkategori}. Når brugere rapporterer en fejl, kan de tilknytte fejlen til en kategori. \classref{Fejlkategori} kunne være erstattet af en værditype-attribut på klassen \classref{Fejl}, men i så fald ville det være svært at tilføje nye fejlkategorier. Derfor har vi modelleret en håndteringen af fejlkategorier som en ny klasse (\classref{Fejlkategori}). Nogle af de fejl, som brugerne rapporterer, kan man forestille sig har behov for at få tilknyttet en lille beskrivelse af fejlen, mens andre fejl ikke behøver dette. En fejl som \fx et dødt link til en opskrift behøver ikke at have en beskrivelse tilknyttet, da det blot medfører at klassen \classref{Fejl} bliver associeret med en opskrift.

Klassen \classref{Vare} er associeret til klassen \classref{Bruger} i form af en indkøbsliste, hvorpå brugerens varer er skrevet på. Vi har ikke modelleret indkøbslisten som en klasse, fordi hver bruger blot har én enkelt indkøbsliste af gangen. En bruger kan altså være tilkoblet mange varer (tilføjet manuelt eller gennem en opskrift) og denne liste af varer bliver dermed gemt på indkøbslisten. Det samme gælder for associationen mellem \classref{Bruger} og \classref{Opskrift}, som er en association i form af en favoritliste. Vi har ikke modelleret favoritter som en klasse, fordi vi har vurderet, at det er blot et forhold mellem brugeren og opskriften. Men derfor skal \classref{Opskrift} være en klasse for sig.
\tjek{Hvad er det for et forhold?}

Klassen \classref{Opskrift} har i problemområdet attributten \textit{kilde}. Da vi i vores aktørspecifikationer kun har givet et eksempel på at Dataudtrækkeren benytter hjemmesider som kilde til opskrifter, og ikke kan forestille os at \Foodl{} vil benytte andre kilder, vælger vi i modelkomponenten at omdøbe attributen \textit{kilde} til \textit{url}. Informanterne fortalte under møde 2, at det ville være rart at kunne se, hvad andre brugere synes om en opskrift. Derfor tilføjer vi attributten \textit{rating} til opskriften, der vil afspejle hvor mange andre brugere, der har valgt at favorisere denne opskrift i forhold til den opskrift, der har opnået flest favoriseringer. Hvis den opskrift, der har fået flest favoriseringer, har fået 200, og \textit{Gulerodssuppe} har fået 50, så får \textit{Gulerodssuppe} ratingen 25 \%, og alt efter hvordan dette designmæssigt bedst vises på en brugergrænseflade, kan de 25 \% mappes til \fx x ud af y stjerner.

I controllerlaget findes klassen \classref{Søgehåndtering}, som indeholder funktionerne \methodref{søg()}, \methodref{skaler()}, \methodref{sorter()} og \methodref{begræns()}. \classref{Søgehåndtering} er dannet ud fra den viden, vi har opnået ved at analysere problemområdet i \chapref{chap:analyseafpo}, hvor man er nødt til at udføre en form for søgning efter opskrifter for at finde opskrifter, man kan lave. \classref{Søgehåndtering} er associeret med klasserne \classref{Opskrift} og \classref{Råvaretype}, fordi man udfører en søgning baseret på råvaretyper, og søgeresultatet er en liste af opskrifter. Det er klassen \classref{Søgehåndtering}, der gør det muligt bl.a. at søge på opskrifter. Søgningen er baseret på brugerindtastede råvaretyper. En bruger kan derefter bruge funktionerne, der findes i \classref{Søgehåndtering} til at skalere, sortere eller på anden vis begrænse søgeresultatet.